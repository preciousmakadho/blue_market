<div class="marketplace-container">
  <!-- Header Component -->
  <app-header></app-header>

  <!-- Dynamic Content based on route -->
  <div *ngIf="showShopContent" class="shop-content">
    <div class="container">
      <h2>Shop Content</h2>
      <p>Current Route: {{ currentRoute }}</p>
    </div>
  </div>

  <div *ngIf="showAccountContent" class="account-content">
    <div class="container">
      <h2>Account Content</h2>
      <p>Current Route: {{ currentRoute }}</p>
    </div>
  </div>

  <!-- Original Marketplace Content (shown when not in shop/account routes) -->
  <div *ngIf="!showShopContent && !showAccountContent">
    <section class="hero">
      <div class="hero-overlay">
        <div class="container hero-content">
          <h2 class="hero-title">Discover Amazing Products</h2>
          <p class="hero-subtitle">Everything you need, all in one place</p>

          <div class="search-filters">
            <select [(ngModel)]="selectedCategory" class="filter-select">
              <option value="">All Categories</option>
              <option *ngFor="let cat of mainCategories" [value]="cat">{{ cat }}</option>
            </select>
            <select [(ngModel)]="selectedPriceRange" class="filter-select">
              <option value="">Price Range</option>
              <option *ngFor="let range of priceRanges" [value]="range">{{ range }}</option>
            </select>
            <select [(ngModel)]="selectedBrand" class="filter-select">
              <option value="">All Brands</option>
              <option *ngFor="let brand of brands" [value]="brand">{{ brand }}</option>
            </select>
            <select [(ngModel)]="selectedRating" class="filter-select">
              <option value="">Any Rating</option>
              <option *ngFor="let rating of ratings" [value]="rating">{{ rating }}</option>
            </select>
            <button class="apply-filters-btn" (click)="applyFilters()">
              <span class="material-icons">tune</span>
              Apply Filters
            </button>
          </div>
        </div>
      </div>
    </section>

    <section class="featured-products">
      <div class="container">
        <div class="featured-products-layout">
          <!-- Shop by Category Sidebar -->
          <app-category-sidebar
            [categories]="categories"
            [expandedCategory]="expandedCategory"
            [hoveredCategory]="hoveredCategory"
            [isCardHovered]="isCardHovered"
            (categoryHover)="onCategoryHover($event)"
            (categoryLeave)="onCategoryLeave()"
            (cardHover)="onCardHover()"
            (cardLeave)="onCardLeave()"
            (toggleCategory)="onToggleCategory($event)"
            (navigateToCategory)="onNavigateToCategory($event)"
            (navigateToSubcategory)="onNavigateToSubcategory($event)"
          ></app-category-sidebar>

          <!-- Category Hover Cards Container -->
          <div class="category-cards-container">
            <!-- Electronics Card -->
            <div 
              class="category-hover-card" 
              *ngIf="hoveredCategory === 'electronics'"
              (mouseenter)="onCardHover()"
              (mouseleave)="onCardLeave()"
            >
              <app-electronics></app-electronics>
            </div>

            <!-- Fashion Card -->
            <div 
              class="category-hover-card" 
              *ngIf="hoveredCategory === 'fashion'"
              (mouseenter)="onCardHover()"
              (mouseleave)="onCardLeave()"
            >
              <app-fashion></app-fashion>
            </div>

            <!-- Home & Garden Card -->
            <div 
              class="category-hover-card" 
              *ngIf="hoveredCategory === 'garden'"
              (mouseenter)="onCardHover()"
              (mouseleave)="onCardLeave()"
            >
              <app-garden></app-garden>
            </div>

            <!-- Sports Card -->
            <div 
              class="category-hover-card" 
              *ngIf="hoveredCategory === 'sports'"
              (mouseenter)="onCardHover()"
              (mouseleave)="onCardLeave()"
            >
              <app-sports></app-sports>
            </div>

            <!-- Beauty Card -->
            <div 
              class="category-hover-card" 
              *ngIf="hoveredCategory === 'beauty'"
              (mouseenter)="onCardHover()"
              (mouseleave)="onCardLeave()"
            >
              <app-beauty></app-beauty>
            </div>

            <!-- Books Card -->
            <div 
              class="category-hover-card" 
              *ngIf="hoveredCategory === 'books'"
              (mouseenter)="onCardHover()"
              (mouseleave)="onCardLeave()"
            >
              <app-books></app-books>
            </div>

            <!-- Toys Card -->
            <div 
              class="category-hover-card" 
              *ngIf="hoveredCategory === 'toys'"
              (mouseenter)="onCardHover()"
              (mouseleave)="onCardLeave()"
            >
              <app-toys></app-toys>
            </div>

            <!-- Automotive Card -->
            <div 
              class="category-hover-card" 
              *ngIf="hoveredCategory === 'automotive'"
              (mouseenter)="onCardHover()"
              (mouseleave)="onCardLeave()"
            >
              <app-automotive></app-automotive>
            </div>

            <!-- Default Products Grid (shown when no category is hovered) -->
            <div class="products-section" *ngIf="!hoveredCategory">
              <app-featured-products
                [products]="getFilteredProducts()"
                [wishlist]="wishlist"
                (addToCart)="onAddToCart($event)"
                (toggleWishlist)="onToggleWishlist($event)"
              ></app-featured-products>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Promo Banners Component -->
    <app-promo-banners></app-promo-banners>

    <section class="new-arrivals">
      <div class="container">
        <div class="section-header">
          <h2>New Arrivals</h2>
        </div>

        <app-featured-products
          [products]="newArrivals"
          [wishlist]="wishlist"
          (addToCart)="onAddToCart($event)"
          (toggleWishlist)="onToggleWishlist($event)"
        ></app-featured-products>
      </div>
    </section>

    <section class="features">
      <div class="container">
        <div class="features-grid">
          <div class="feature-box">
            <div class="feature-icon">
              <span class="material-icons">local_shipping</span>
            </div>
            <div class="feature-content">
              <h3>Free Shipping</h3>
              <p>Free delivery for orders over $50</p>
            </div>
          </div>
          <div class="feature-box">
            <div class="feature-icon">
              <span class="material-icons">security</span>
            </div>
            <div class="feature-content">
              <h3>Secure Payment</h3>
              <p>100% secure payment processing</p>
            </div>
          </div>
          <div class="feature-box">
            <div class="feature-icon">
              <span class="material-icons">support_agent</span>
            </div>
            <div class="feature-content">
              <h3>24/7 Support</h3>
              <p>Round-the-clock customer service</p>
            </div>
          </div>
          <div class="feature-box">
            <div class="feature-icon">
              <span class="material-icons">assignment_return</span>
            </div>
            <div class="feature-content">
              <h3>Easy Returns</h3>
              <p>30-day return policy</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="blog">
      <div class="container">
        <h2 class="section-title">From Our Blog</h2>
        <div class="blog-grid">
          <div class="blog-card" *ngFor="let post of blogPosts">
            <div class="blog-image">
              <img [src]="post.image" [alt]="post.title" loading="lazy" />
              <div class="blog-category">{{ post.category }}</div>
            </div>
            <div class="blog-content">
              <h3>{{ post.title }}</h3>
              <div class="blog-meta">
                <span>{{ post.date }}</span>
                <span>By {{ post.author }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Shop by Brands Component -->
    <app-shop-brands [brands]="marketplaceBrands"></app-shop-brands>
  </div>

  <!-- Footer Component -->
  <app-footer></app-footer>
</div>